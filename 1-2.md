### モノの存在のための基盤

#### ゆるやか集合論

集合という概念を提示する方法として、成り立つべき前提を厳密に論理的にかき集めた「公理的集合論」というものがあります。様々な技巧的問題を解決した結果現在は==ZFC==という名前の公理的集合論を採用されることが多いわけですが、基本的にはそこまで丁寧にやらなくても「間違った推論」をすることはそう多くはありません。そんなわけで論理という言語をベースにしながら、集合論についてできるだけ真面目に考えてみます。

集合とは、**モノの集まり**です。しかしモノもまた集合であり、つまり「集まり」という概念だけで世界を構成しようという試みになります。例えば集合としてはこんなものがあります:

- ==空集合, empty set==: 何も入ってない集合

ありそうです。これを $\varnothing$ と呼びますが、その為にはちょっとした準備が必要です。何も入ってないことを示す為に「入っている」という関係性を述語にする必要があるのです。これを $x \in A$ と表記し、$x$ が集合 $A$ の==要素, element==であることを示します。すると「$X$ が空集合である」という述語は $\forall x. \neg (x \in X)$ と表記できます。以降 $\neg (a \in A)$ は $a \not\in A$ と表記します (このように演算子として書かれた述語記号に $\mathop{\not{}}\ {}$ がついたものはその述語の否定を表します)。

> ちなみに他に (予め在ると信じられた) 述語はありません。組み合わせによって増えていくのみです。

そして2つの集合 $A,B$ が等しいことを「何かを含んでいるという関係で区別できないこと」とします。即ち $\forall x. (x\in A \Rightarrow x\in B) \land (x \in B \Rightarrow x \in A)$ です。これは省略されて $\forall x. x \in A \Leftrightarrow x \in B$ と書かれ、$A = B$ と呼びます。これが**等しさの定義**です。

ここで重要な性質である「空集合は一つしかない」ことが証明できます。これで初めて $\varnothing$ という表記がある特定のモノを示していることがわかり、記号の利用が正当化されるのです。何かが一つしかない、即ち==一意, unique==であることを示すには2つ在ると仮定してそれらが一致することを示します。

- $proof$ $A,B$ が空集合だとする。
- 定義より、$\forall x. x \not\in A$ 及び $\forall x. x \not\in B$.
- ここで任意の $x$ をとる。
    - さっき言ったので $x \not\in A$ 及び $x \not\in B$.
    - すると $x \in A \Rightarrow x \in B$ が導出できる。
        - 何故なら $x \in A$ を仮定すると、前提の $x \not\in A$ と合わせて矛盾。
        - よって $x \in B$ を導出できる。
    - 同様に $x \in B \Rightarrow x \in A$.
    - したがって $x \in A \Leftrightarrow x \in B$.
- よって $\forall x. x \in A \Leftrightarrow x \in B$.
- 従って $A = B$.

というわけで証明ができました。とてもそれっぽくていいですね。

> 厳密な証明の為には本来は全ての導出過程で「どの前提・等式・性質を使ったのか」を明示しなければなりません。でも基本的にどれを参照しているかは上を辿っていけばわかるので省略される傾向にあるようです。
> なお、**本当に厳密**にするには当然この導出過程すら記号で表記するべきです。でもその記号表記を記述する言語がなければ始まらないのでどこかで妥協は必要なのです。その上で、実際に記号のみで証明を書ける言語は**実在**します (定理証明支援系など)。

さて、当然他にもたくさんの集合があります。今まで知っているものをかき集めて新しい集合を作ってみようと思うと、今は「$\varnothing$ のみが入った集合」しかありません。これを $\{\varnothing\}$ と呼びます。同様に括弧で囲むことで $\{\{\varnothing\}\}$ や $\{\varnothing, \{\varnothing\}\}$ という集合を作れ、例えば $\varnothing \not\in \{\{\varnothing\}\}$ となります (要素は $\{\varnothing\}$ だけなので)。この方法を続けていくと無限に集合があることがわかるし、それらを使って無限に要素がある集合を作ることができます。無限は定義していませんが。

> ちなみに集合は「要素を含むかどうか」でしか区別できないので、例えば $\{\varnothing,\varnothing\} = \{\varnothing\}$ 及び $\{\varnothing,\{\varnothing\}\} = \{\{\varnothing\},\varnothing\}$ が成り立ちます。無限集合を作るには同じ要素を集めても意味がなくて、例えば $\varnothing, \{\varnothing\}, \{\{\varnothing\}\},\{\{\{\varnothing\}\}\}$ のように等しくないものたちを無限にかき集めなければなりません。 

また、集合を構成するには「$x\in A$ となる $x$ についての等価条件」を指定する方法があります。実はこれはどんな条件でも指定できるようにすると**世界が崩壊する**ことが知られているのですが、概ね問題はありません。

これを使うと例えば集合 $A$ に対して $a \in U\Leftrightarrow (\forall x \in a. x \in A)$ とした集合 $U$ を考えることができます。$U$ に含まれている集合 $a$ の要素 $x$ は全て $A$ の要素なわけですが、そんな集合を $A$ の==部分集合, subset==と呼びます。例えば $A\in U$ だし、$\varnothing \in U$です。そして $A$ の部分集合を全部かき集めた集合 $U$ そのものを $\mathcal{P}(A)$ と書き、$A$ の==冪集合, powerset==と呼びます。

先程どんな条件でも指定できるようにすると問題があることを書きましたが、ある集合の部分集合であることを強制すると問題ないことが知られています。よって、 $\{x\in A\mid P(x)\}$ という表記で「$A$ の要素で述語 $P$ を満たすもの」からなる集合を表すこととします。これは自動的に $A$ の部分集合ですね。

これで概ね集合を扱う準備はできました。あとは便利な記号をちょっとつくっておきましょう。

- $a\subseteq A \iff \forall x \in a. x \in A$ 
    - 部分集合であることを表します。
- $A \cap B = \{x \in A \mid x \in B \} = \{x \in B \mid x \in A\}$
    - $A$ にも $B$ にも入っている要素からなる集合で、==共通部分, intersection==と呼びます。
- $A \setminus B = \{x \in A \mid x \not\in B\}$ 
    - $A$ から $B$ の要素を抜いた集合、==差集合, difference==です。
- $A \cup B$ は $x \in A \cup B \iff x \in A \lor x \in B$ で定義します。
    - $A$ か $B$ に含まれる要素からなる集合、==和集合, union==です。
- $(A,B) = \{\{A\},\{A,B\}\}$ 
    - これは定義は気にしないほうが良いです。**定義は往々にして本質ではありません。**
    - ここでの本質は $(A,B) = (C,D) \iff A = C \land B = D$ が成り立つことです。
        - $A = B$ のとき、$(A,B) = \{\{A\}\}$ となります。これと等しくなるには $C = D$ で、さらに $A = B = C = D$ である必要があります。
        - $A \ne B$ のとき、$(A,B)$ には2つの要素 $\{A\}$ と $\{A,B\}$ が含まれます。これと等しくするには $C \ne D$ で、1要素の集合 $\{A\}$ が $\{C\}$ と一致し、残りの $B$ も $D$ と一致しなければなりません。
    - つまりは $A$ と $B$ を順序込みで独立して保持する物体です。これを==組, pair==と呼びます。
- $A \times B$ は $x \in A \times B \iff \exists p. \exists q. p \in A \land q \in B \land x = (p,q)$ で定義されるものです。
    - $A$ と $B$ の要素の組すべてからなる集合で、==直積集合, direct product==と呼びます。
    - $\{x,y\} \times \{x,y\} = \{(x,x),(x,y),(y,x),(y,y)\}$ です。

後は便利表記です。

- $\forall x \in A. P(x) \iff \forall x. x \in A \Rightarrow P(x)$
    - ここでの $x\in A$ は条件に当てはまらない場合を真とする役割があります。
- $\exists x \in A. P(x) \iff \exists x. x \in A \land P(x)$
    - ここでの $x\in A$ は条件に当てはまらない場合を偽とする役割があります。
- $\forall x,y,z. P(x,y,z) \iff \forall x. \forall y. \forall z. P(x,y,z)$ 
    - 数を増やしたときも同様、$\exists$ に関しても同様。以下同じ。
    - $\forall x,y\in A. P(x,y) \iff \forall x \in A. \forall y \in A. P(x,y)$
    - $\forall x\in A, y \in B. P(x,y) \iff \forall x \in A. \forall y \in B. P(x,y)$
- $\exists !x \in A. P(x) \iff (\exists x\in A. P(x))\land (\forall x,y\in A. P(x) \land P(y) \Rightarrow x = y)$
    - 存在し、一意であることを表します。

#### モノの対応を示すモノ

$A\times B$ の部分集合を==関係, relation==と言います。それだけだと何も感情がわかりませんが、関係は $A$ の要素と $B$ の要素それぞれに対して「関係に含まれているかそうでないか」が判定できる物体と言えます。例えば $\{(x,y)\in A \times A \mid x = y\}$ という $A$ と $A$ に関する関係は「等しい」という関係を示すものと言えそうです。

> $\{(x,y)\in A\times B \mid P(x,y)\}$ という表記は $A \times B$ の要素が $(x,y)$ しかないことによって正当化されます。

そして関係の中でも、「片方を定めたときに対応する要素がちょうど一つしかない」ものを==写像, map==と呼びます。つまり関係 $R \subseteq A \times B$ が写像であるとは、$\forall x\in A. \exists ! y\in B. (x,y) \in R$ という意味です。

> 「関係 $R \subseteq A \times B$ が」という文は、$A \times B$ の部分集合である $R$ があったとして、これは関係となる、という情報を与えるものです。ついでに $A \times B$ の部分集合ということは $\mathcal{P}(A\times B)$ の要素ということです。 このような書き方の利用頻度はとても高いので慣れると良いと思います。

そうなると、この写像を用いて $x\in A$ に対応する唯一の要素を取り出すことができるはずです。これを $R(x)$ と表記することにします。つまり $y = R(x) \iff (x,y) \in R$ です。以上より、写像を仮定するときには $A$ の要素から $B$ の要素が定まることを意味して $R : A \to B$ と表記されます。この矢印の左側が写像の==定義域==及び==始域, domain==、右側が==終域, codomain==です (なお「値域」は違う概念です)。 

写像 $f : A \to B$ は全ての $x \in A$ に対応する $B$ の要素を割り当ててあげれば十分定義できます。よって、この性質を用いて具体的な写像を定義することが多いです。例えば $f : \{x,y\} \to \{z,w\}$ という写像を与えるには $f(x),f(y) \in \{z,w\}$ という2つの割り当てがあればよく、$f(x) = z, f(y) = w$ と書けば1つ写像が定まるわけです。また、割り当てそのものが写像であるという考えの下、$x \mapsto y$ という表記で「$x$ を $y$ に割り当てる写像そのもの」を表します。例えば $f(x) = f(y) = z$ である写像は、$a \mapsto z$ と表現できます(つまり全てを $z$ に割り当てる写像)。

写像は基本的には「モノを写す」という操作を表すわけですが、その表現力はそれに留まりません。写す先や解釈によって様々な役割を担うことができます。例えば $\mathbf{2} = \{0,1\}$ として$P : A \to \mathbf{2}$ という写像があるとしましょう。これは $A$ の各要素に $0$ か $1$ かを割り当てるものです。ここで集合 $P' = \{x \in A\mid f(x) = 1\}$ を考えると、色んな $P$ に対して $A$ の**部分集合**が対応することがわかります。逆に $A$ の部分集合 $a$ に対しては、各 $x \in A$ に対して $x \in a$ なら $1$ 、そうでないとき $0$ を返す**写像** $a' : A \to \mathbf{2}$ を構成することができます。実は「$A$ の部分集合」は「$A \to \mathbf{2}$ である写像」と**ほぼ同じ**ものであることがわかるのです。

この直観を丁寧に示すために、まず $A$ から $B$ への**写像全体の集合**を $[A,B]$ と書くことにします。$[A,\mathbf{2}] = \mathcal{P}(A)$ というのがほしい結論ではありますが、明らかにこれは成り立ちません。ですが、2つの写像 $f: [A,\mathbf{2}] \to \mathcal{P}(A), g : \mathcal{P}(A) \to [A,\mathbf{2}]$ を次のように定義できます。 

- $f(P) = \{x \in A\mid P(x) = 1\}$
- $g(a) = x \mapsto \begin{cases}1&\text{if }x \in a\\0&\text{otherwise }\end{cases}$

> $\text{if}$ とか書いていいのか、と思うかもしれません。集合による元来の定義で書けば $g(a) = \{y\in A \times \mathbf{2}\mid \exists x\in A. (x \in a \land y = (x,1)) \lor (x \not\in a\land y = (x,0))\}$ となります。基本的にはだいたい問題ないのです。
> そういえばまだ $0$ と $1$ は定義してませんが、$0\ne 1$ ならなんでもいいです。

これによって2つの世界を行き来できるようになりました。そして次の事実がわかります。

- $g(f(P)) = P$
    - $g(f(P)) = \left(x \mapsto \begin{cases}1&\text{if }P(x) = 1\\0&\text{otherwise}\end{cases}\right) = x \mapsto P(x) = P$
- $f(g(a)) = a$
    - $f(g(a)) = \{x \in A\mid x \in a\} = a$

つまりどちらに於いても「行って戻ると変わってない」のです。これが**ほぼ同じ**の厳密な定義で、この状況を==同型, isomorphic==と呼びます。

> $f : A \to B, g : B \to A$ で同型になるとき、$A$ と $B$ が同型であるとも言います。$f$ が同型、$g$ が同型とも言います。同型であるとき $A \cong B$ と書き、調子に乗って $f : A \cong B$ と書くこともあります。もっと調子に乗ると $f : A \cong B : g$ とも書きます。

お互いの対応が取れることを以ってほぼ等しいとみなすのです。実際細かい違いを考慮しなくて良いケースは少なくないので、同型ならまぁいい、みたいな扱いをしたりするのです。また、$f : A \cong B$ と言われたときには逆向きの $B \to A$ の写像が存在するはずです。これを $f^{-1}$ と書き、==逆写像, inverse==と言います。逆写像はもちろん同型です。

> ある写像が同型のとき、逆写像は一意です。なので名前をつけることができます。証明はしません。

同型を丁寧に書くためにちょっとした定義をします。写像 $f:A \to B, g : B \to C$ があるとき写像 $g \circ f : A \to C$ を $x \mapsto g(f(x))$ で定義します。これを==合成写像, composition==と呼びます。また、集合 $A$ に対して写像 $1_A : A \to A$ を $x \mapsto x$ で定義します。これを==恒等写像, identity==と呼びます。計算するとわかりますが、任意の写像 $f:A \to B$ に対して $1_B \circ f = f = f \circ 1_A$ です。

> 写像は各要素の割り当てのみで定まるので、写像の等しさは「定義域の全ての要素に対して、終域の同じ要素を割り当てていること」であると言えます。これは関係、即ち集合として捉えたときの等しさに一致します。

これを用いると、写像 $f:A \to B$ が同型であるとは、$\exists g\in[B,A]. g \circ f = 1_A \land f \circ g = 1_B$ と定義できます。ついでに集合 $A,B$ が同型であると言うのは $\exists f\in [A,B], \exists g\in [B,A]. g \circ f = 1_A \land f \circ g = 1_B$ です。

> $\exists f \in [A,B]$ を $\exists f:A \to B$ のように書いたりもします。このような記法の拡張はよく行われるので、毎度確認するよりもやりたいことを考えて意味の通りそうな解釈を発想できる方がいいのかもしれません……表記には本来こだわりたくないものなのです。

あとは良く使うおまけです。

- $f : A \to B$ が==単射, injective==である $\iff \forall x,y\in A. f(x) = f(y) \Rightarrow x = y$
    - $B$ のある要素に辿り着く $A$ の要素が**高々1つ**であることを示します。
- $f : A \to B$ が==全射, surjective==である $\iff \forall b\in A. \exists a\in A. f(a) = b$
    - $B$ のある要素に辿り着く $A$ の要素が**少なくとも1つ**あることを示します。
- $f : A \to B$ が==全単射, bijective==である $\iff f$ が単射かつ全射 
    - このとき $B$ のある要素に辿り着く $A$ の要素は**丁度1つ**あることになります。
    - すると $B$ の各要素に対して $A$ の要素を逆向きに割り当てる写像を作り上げることができるはずです。即ちこれは**同型と同じ**です。
        - 同型は集合に限らず広い意味で使われる語です。全単射は集合間の写像についてのみの語なのです。
- $f : A \to B$ に対し、$f_* : \mathcal{P}(A) \to \mathcal{P}(B) = a \mapsto \{y\in B \mid \exists x\in a. y = f(x)\}$
    - この写像そのものや、写した先 $f_*(a)$ のことを==像, image==または==順像, direct image==と呼びます。
    - 写した先の集合のことがいわゆる==値域, range==にあたるものです。
- $f : A \to B$ に対し、$f^* : \mathcal{P}(B) \to \mathcal{P}(A) = b \mapsto \{x\in A \mid \exists y \in b. y = f(x)\}$
    - こちらは==逆像, inverse image==と呼ばれます。逆写像と違ってどんな写像にも逆像は作れます。
    - 逆像は順像に比べて「性質が良い」ことが知られています。
        - 定義も $f^*(b) = \{x\in A\mid f(x)\in b\}$ と少し簡単に書けます。
        - 同型 $\mathcal{P}(A) \cong [A,\mathbf{2}]$ を使うと $f^*(b) = b\circ f$ とすら書けます。
    
これでモノを創造・操作するための基盤は殆ど整いました。後は適宜追加していくことにしましょう。
