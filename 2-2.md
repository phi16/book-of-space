### 行列

ある線形写像 $f:V \to W$ が与えられたとき、これについて考えることは「ある基底で表現した写像」$\hat{f} : F^{\dim V}\to F^{\dim W}$ について考えることとほぼ同じなはずです。

一般に線形写像 $f : F^m \to F^n$ について知りたいことになるわけですが、これは明らかに $f(e_i)\in F^n$ によって決定します。よって「$m$ 個の『$n$ 個の $F$ の組』の組」のことを考えればいいわけなのです。写像 $\{1,\ldots,n\}\times\{1,\ldots,m\}\to F$ を $n\times m$ の**行列**と言います。行列 $M$ に対して、$M(i,j)$ のことを $M_{ij}$ と書くことにします。

> **出力が左、入力が右**です。理由は後でわかります。
> 以後 $[n] = \{1,\ldots,n\}$ とします。この表記は同値類と被っていますが、文脈上判断できると思います。

これを使って線形写像 $f:V\to W$ に基底を与えて行列 $M_f:[\dim W] \times [\dim V] \to F$ として表現したものを**表現行列**と呼びます。

> 線形空間が $F$ の組であったように、線形写像も $F$ の組に過ぎないということがわかったわけです。

2つの線形写像 $f,g: V \to W$ があるとき、それらの足し算 $f+g = v\mapsto f(v)+g(v)$ を考えるとこれは線形写像です。そして表現行列は $M_f + M_g$ になります。同様にして $r\in F$ に対してスカラー倍 $rf = v\mapsto rf(v)$ が定義でき、表現行列は $rM_f$ になります。**つまり線形写像の成す空間 $[V,W]$ は線形空間になり、$\dim W\times \dim V$ 行列の成す空間もそれと同型な線形空間になる**ということです。

そして線形写像に備わっていた重要な演算として**合成**がありました。$f: U \to V, g : V \to W$ に対して $g\circ f: U \to W$ は線形写像になります。これに対応して、2つの行列 $M_f, M_g$ に対して**行列積**$M_g\times M_f:[\dim W]\times [\dim U] \to F$ を次で定義できます。

$(M_g\times M_f)_{ki} = \sum\limits_j (M_g)_{kj}(M_f)_{ji}$

> ここで $i = 1,\ldots,\dim U, k = 1,\ldots,\dim W$ です。総和の範囲は $j = 1,\ldots,\dim V$ です。具体的な計算をするには当然範囲を知らないといけませんが、本質的な部分からはちょっと離れているので省略をしたりします。
> 出力が左、入力が右な理由は写像の合成がその向きだからです。添字も $k\leftarrow j, j\leftarrow i$ を合わせて $k\leftarrow i$ と、一貫していることがわかると思います。
> 以後、行列積の記号は省略します (積なので)。

つまり**関数合成を具体的に計算できる**ようになったのです。何も条件が与えられてなければ当然合成された関数は「その2つの関数」そのものを覚えてなければいけませんが、線形空間の線形写像の場合にはもっと単純な形式で保存ができるわけです。

一般に行列は実際に「$m\times n$ 個の $F$ の要素」で表現されることが多いです。$m$ を縦向きに、$n$ を横向きに記すとすれば例えば $f = (x,y,z)\mapsto (x+y,y-z) : F^3 \to F^2$ という線形写像は次のように表現できます。

- $f(1,0,0) = (1,0), f(0,1,0) = (1,1), f(0,0,1) = (0,-1)$ です。
- よって $M_f = \begin{bmatrix}1&1&0\\0&1&-1\end{bmatrix}$ となります。

また、$F^n$ の要素 $v$ は $F^1$ からの線形写像 $r \mapsto rv$ と捉えることができます。これをさらに行列表現することで**行列のみで線形空間に関する計算が出来る**ことになるのです。

- 実際に値 $v=(1,3,2)$を入れてみると $\begin{bmatrix}1&1&0\\0&1&-1\end{bmatrix}\begin{bmatrix}1\\3\\2\end{bmatrix} = \begin{bmatrix}4\\1\end{bmatrix}$ です。
- 何故ならまず $\mathbf{2}\leftarrow \mathbf{3}, \mathbf{3}\leftarrow \mathbf{1}$ の積なので結果は $\mathbf{2}\leftarrow \mathbf{1}$ になるはず。
- 積 $M:\mathbf{2}\times\mathbf{1}\to F$ は $M_{k1} = \sum\limits_j (M_f)_{kj}(M_v)_{j1}$ で計算できます。
    - $M_{11} = (M_f)_{11}(M_v)_{11} + (M_f)_{12}(M_v)_{21} + (M_f)_{13}(M_v)_{31} = 1\cdot 1 + 1\cdot 3 + 0\cdot 2 = 4$
    - $M_{21} = (M_f)_{21}(M_v)_{11} + (M_f)_{22}(M_v)_{21} + (M_f)_{23}(M_v)_{31} = 0\cdot 1 + 1\cdot 3 + (-1)\cdot 2 = 1$
- よって $M = \begin{bmatrix}4\\1\end{bmatrix}$ で、また実際 $f(v) = (4,1)$ となります。

> ここで $-1$ や $3$ と書いているのは $0+(-1)$ や $1+1+1$ という意味で、これは任意の体に存在するものです。

つまり線形空間について考えるということは行列について考えるということなのです。実質。

> なお行列には「積」が定まってはいるものの、$m\times n$ 行列同士を掛けることは一般には出来ません。今回定まっている積は本質的に写像の合成なわけで、間に挟まれている空間が一致していなければいけないのです。つまり $m\times n$ 行列と $n\times p$ 行列は掛けられますが、**逆には掛けられない**のです (定義が存在しないのです)。
> 逆に言えば常に終域と始域が一致する $m\times m$ 行列全体の成す集合 $\mathrm{Mat}_F^m$ には二項演算としての積 $\cdot : \mathrm{Mat}_F^m \times \mathrm{Mat}_F^m \to \mathrm{Mat}_F^m$ が存在し、**環を成します**。この環の単位元を**単位行列**と言い、$\begin{bmatrix}1&0&\cdots&0\\0&1&&\vdots\\0&&\ddots&\vdots\\0&0&\cdots&1\end{bmatrix}$ という行列で表せます。

適当な例として**フィボナッチ数列** $1,1,2,3,5,8,\ldots$ について考えてみましょう。これは「次の数は、今の数と1個前の数の和」という定義で $1,1$ から順番に構成されていく数列です。この列の定義には**和**しか含まれていません。なのでうまいことやると線形の枠組みで表現できる可能性があるわけです。

実際、「次の数を定めるのに必要な要素全て」を集めてみると、この数列は $(0,1),(1,1),(1,2),(2,3),(3,5),(5,8),\ldots$ となります。このとき、**今の状態から次の状態を求める写像は線形写像になります**。何故なら $(x,y)\mapsto (y,x+y)$ だからです。この写像を $F:\mathbb{R}^2\to\mathbb{R}^2$ としましょう。すると、次の方法で**ある状態の8つ次の状態**を求めることができます。

- $M_F = \begin{bmatrix}0&1\\1&1\end{bmatrix}$ と表せます。
- 「8つ次の状態」を求める写像は、「1つ次の状態」を求める写像を8回合成したものです。
- これは即ち $M_F^8$ のことです。そしてこれは $((M_F^2)^2)^2$ のことです。つまり:
- $M_F^2=\begin{bmatrix}1&1\\1&2\end{bmatrix}, M_F^4=\begin{bmatrix}2&3\\3&5\end{bmatrix}, M_F^8=\begin{bmatrix}13&21\\21&34\end{bmatrix}$ より:
- $(1,1)$ の8つ次の状態 $F^8(1,1)$ は、$M_F^8\begin{bmatrix}1\\1\end{bmatrix} = \begin{bmatrix}34\\55\end{bmatrix}$ なので $(34,55)$ であることがわかるのです。

元々は8回の計算が必要だったはずの演算が3回の行列積で済むようになりました。行列積自体の計算が大変とはいえ、これは65536回の演算が16回の行列積で済むような話なので大幅な改善なのです。**空間の構造がよくわかると簡単な計算方法が見つかる**のです。
