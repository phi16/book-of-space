### 測量をする道具

線形空間に於いて、基底というのは**空間に軸を建てる**ための情報でした。軸があることで座標が記せ、場所を明示的に表現することができるようになるのです。でも、このとき軸には「座標が一意であること」しか制約が無いのです。つまり、例えば軸は**傾いても良い**ようになっています。

例えば $[\mathbf{2},\mathbb{R}]$ は各点上の演算で線形空間になりますが、基底として $x\mapsto x$ と $x\mapsto 1$ を採用できます。実際 $f\in[\mathbf{2},\mathbb{R}]$ に対して $f = (f(1)-f(0))(x \mapsto x) + f(0)(x\mapsto 1)$ が成り立ちます。しかし直観的には $f(0)$ と $f(1)$ の値を座標にしたいような気がします。**ただその独立性を基底は知らない**のです。「同じ向き」でないことはわかっても、「完全に違う向き」であることを知らないのです。でも線形空間の構造だけからはこれがわからないので、新たな構造を必要としている状況にあります。

$F$ 上の線形空間 $V$ に対して==双対空間, dual space== $V^* = [V,F]$ を定義します (これは線形写像の成す空間)。これはつまり**ベクトルを与えると何かを測った値を返す**モノのことです。特に線形写像であることはありがたくて、「2倍のベクトル」に対しては「2倍の値」を返すことが保証されるわけです。例えば $\hat{e}_i\in [F^n,F]$ として「$i$ 番目の要素を返す写像」を考えることができ、$\hat{e}_i(e_i) = 1, \hat{e}_i(e_j) = 0\ (i\ne j)$ となることがわかります。

これを用いて、**全てのベクトルに対して、その向きの値を抽出する測量機**を備えさせることで軸の関わりを調べようというのです。つまり線形写像 $\hat{-}:V \to V^*$ のことです。この考えを元に次の定義を行います。

順序体 $F$ 上の線形空間 $V$ に==内積, inner product==が備わっているというのは:

- 線形写像 $\hat{-}:V\to V^*$ が存在して次を満たすことを言う。
- $\hat{x}(x) \ge 0$ (正定値性)
    - 自分自身を測ると非負。
- $\hat{x}(y) = \hat{y}(x)$ (対称性)
    - 測りと測られるものの立場は同じ。

このとき $\langle x,y\rangle = \hat{x}(y)$ とすれば対称性が見やすくなります。内積を備えた線形空間を==内積空間, inner product space==と呼びます。

> 一般には $\langle x,y\rangle$ のことを内積と定義する方が主流です。実際 $\hat{x} = y \mapsto \langle x,y\rangle$ なので特に差はありません。今回は座標の抽出という側面で書いてみました。

先程考えた $\hat{e}_i$ は線形性によって $F^n \to (F^n)^*$ へと拡張することができます。結果得られる内積を==標準内積, standard inner product==と言います。線形写像 $F^n \to F$ は $1\times n$ 行列と捉えることができるわけですが、標準内積はベクトルである $n\times 1$ 行列を**傾けて** $1\times n$ 行列にする方法、と捉えることができます。この「傾ける」演算を==転置, transpose== $v \mapsto v^T$ と呼びます。

例えば $\left\langle \begin{bmatrix}2\\3\end{bmatrix}, \begin{bmatrix}-1\\2\end{bmatrix}\right\rangle = \begin{bmatrix}2&3\end{bmatrix}\begin{bmatrix}-1\\2\end{bmatrix} = 2 \times (-1) + 3\times 2 = 4$ というわけです。即ち $F^n$ 上の標準内積は $\langle x,y\rangle = \sum\limits_i x_iy_i$ で表せるのです。わかりやすいですね。

> 逆に、$F^n$ 上の全ての内積はほぼ転置で表せます。というのは、$M_{ij} = \langle e_i,e_j\rangle$ という行列を考えると $\langle x,y\rangle = x^TMy$ になることが知られています。標準内積の場合は $M=1$ だったわけです。

さて、元々軸の関わりを知りたいというモチベーションで内積を導入したのでした。$\langle x,y\rangle = 0$ であるとき $x$ と $y$ は==直交, orthogonal==すると言い、全ての基底のベクトルが互いに直交するとき==直交基底, orthogonal basis==と言います。やっと座標系を綺麗に書けるようになりました。とは言え最高にはまだ足りません。

内積は直交性以外にも長さを測るのにも使えます (なので線形性を持つのです)。$\mathbb{R}$ 上の内積空間について、==ノルム, norm== $\|x\| = \sqrt{\langle x,x\rangle}$ を定義します。これを使うとこの空間に==距離== $d(x,y) = \|x-y\|$ を導入でき、距離空間になります。そして、直交基底の全てのベクトルのノルムが $1$ のとき、==正規直交基底, orthonormal basis==と言います。これが一番綺麗な座標系です。正規直交基底 $v_i$ に於いては $\langle v_i,v_i\rangle = 1, \langle v_i,v_j\rangle = 0\ (i\ne j)$ が成り立つわけですが、これは明らかに逆も成り立ちます。

> 内積の定義のときにさらっと**順序体**を要求したり、今回は**実数**にまで要請が強くなってたり、だんだん条件を満たすのが厳しくなっています。だからこそ出来ることが多いわけではありますが。
> なお**正規直交基底の定義に本来実数は必要ありません**。話の流れでそうなっていますが、$\sqrt{\langle x,x\rangle} = 1\iff|\langle x,x\rangle| = 1$ なのでこっちを定義にすれば順序体で十分です。以後そのように扱います。

明らかに $e_i$ は正規直交基底なわけですが、それ以外にも正規直交基底はたくさんあります。例えば $\mathbb{R}^2$ に於いて $(1,0),(0,-1)$ は正規直交基底です。それ以外にも $(3/5,4/5),(-4/5,3/5)$ は正規直交基底です (計算すればわかります)。実際、次が成り立ちます。

- $\mathbb{R}^2$ 上の正規直交基底は $(\cos\theta,\sin\theta),(-\sin\theta,\cos\theta)$ か、$(\cos\theta,\sin\theta),(\sin\theta,-\cos\theta)$ で表せる。
    - $(a,b),(c,d)$ と置くと、次が成り立つ。
        - $a^2+b^2=1$
        - $c^2+d^2=1$
        - $ac+bd = 0$
    - 1つ目の仮定から $a=\cos\theta,b=\sin\theta$ と表せる。
        - 何故なら $(\cos\theta,\sin\theta)$ は円周の全域を渡るため。
    - 3つ目の仮定から $c=\lambda\sin\theta, d=-\lambda\cos\theta$ と表せる。
        - $c\cos\theta=-d\sin\theta$ なので。
    - 2つ目の仮定から $\lambda = \pm 1$ である。

> 回転した世界が区別できないのはわからなくもない感じがありますが、内積だけだと**鏡写しになっている世界**すら区別できないのです。空間そのものに**向き**を備えると区別ができるようになります。ちなみに $\mathbb{R}^3$ だと外積を使うと区別できますが、$\mathbb{R}^2$ には**存在しません**。
> 存在しないというのは「外積」という名前で数学上定義された概念に相当する物体を $\mathbb{R}^2$ 上には定義できないという意味で、$(x_1,x_2)\times(y_1,y_2) = x_1y_2-x_2y_1$ という演算を作ることは自由です。ただ数学に於ける外積はベクトルを返すものなのです。2次元だと軸の向きが足りないのです。
> もっと自然な考え方としては $n$ 次元空間に於いて「$n-1$ 個のベクトルに直交するベクトルを返す」演算と捉えることができて、$\mathbb{R}^2$ なら $(x,y) \mapsto (-x,y)$ または $(x,y)\mapsto (x,-y)$ を**ある種の**外積と呼ぶことはできます。先の「非合法」外積はこれと内積を組み合わせれば復元され、$\mathbb{R}^3$ の通常の外積はこの扱いと一致します。

ところで $F^n$ の基底は**座標から元の空間への対応** $F^n \to F^n$ を導きます。つまりこれは $n\times n$ 行列で、実際に基底が単に横に並んだ行列になります。そして基底は元の空間から座標への対応を一意に作れるはずなので、この行列の**逆元**が存在することになります。逆元が存在する $n\times n$ 行列全体を==一般線形群, general linear group== $\mathrm{GL}_n(F) = \{M\in\mathrm{Mat}_n(F) \mid \exists M'. MM'=1=M'M\}$ と呼び、名前の通り群を成します。これは $F^n$ の基底全体の成す空間と一致します。

この考え方を用いると、正規直交基底 $M_i$ を行列 $M$ とみなした時に $M_i^TM_i = 1, M_i^TM_j = 0\ (i\ne j)$ であることが従います。行列はとても良くできていて、ここから $M_i^TM = e_i$ が従い、そして $M^TM = 1$ が従います (転置は一般の行列に定義できるのです)。これを満たす行列 (==直交行列, orthogonal matrix==) を集めて==直交群, orthogonal group== $\mathrm{O}_n(F) = \{M\in \mathrm{GL}_n(F)\mid M^TM = 1\}$ を定義すると、これは正規直交基底の全体に一致して $\mathrm{GL_n}(F)$ の部分群になります。

- $M^TM=N^TN=1$ のとき、$(MN)^T(MN) = N^TM^TMN = N^TN = 1$ です。
    - 積の転置が逆順になるのは計算をするとわかります。
- 逆元については $M^{-1} = M^T$ で、$(M^{-1})^TM^{-1} = MM^T = MM^{-1} = 1$ です。
    - $\mathrm{GL}_n(F)$ の部分群なので $M^{-1}$ の存在は最初からわかっています。

$\mathbb{R}^2$ についての考察で正規直交基底が**概ね回転**を表現することがわかったと思います。実際、空間全体を正規直交基底 $M$ で写してあげると $\langle Mx,My\rangle = (Mx)^TMy = x^TM^TMy = x^Ty = \langle x,y\rangle$ と内積を保っています。至るところの長さを保つ線形変換は**ほぼ回転**しかありません。が、実は $(1,0),(0,-1)$ が正規直交基底であったように、**反転**を許している状況にあります。先程言及したように、反転かそうでないかを判断する為には何か新たな情報が必要なのです。

$n$ 個のベクトル $v_i \in F^n$ に対し、==行列式, determinant==と呼ばれる演算 $\det:F^n\times \cdots\times F^n \to F$ を次で定義します。

- 各入力されたベクトルに関して線形 (==多重線形性, multilinearity==)。
- 入力が線形独立でないなら $0$. 
- 標準基底を入力すると $1$.

これは定義には成り得ませんが、これを満たす写像は唯1つしか存在しないことが示せます。

- 多重線形性より入力は $e_j$ のみを考えれば良い。
- 同じベクトルを入力すると $0$ になるので標準基底の**並び替え**だけを考えれば良い。
- 基底の2つのベクトルを入れ替える度に符号が反転する。
    - $\det(v_1,v_2) + \det(v_2,v_1) = \det(v_1,v_2) + \det(v_1,v_1) + \det(v_2,v_2) + \det(v_2,v_1)$
    - 多重線形性よりこれは $\det(v_1+v_2,v_1+v_2) = 0$ に等しい。
    - 一般の次元の場合でも同様。
- 全ての並び替えは「2つの入れ替え」の合成に分解できる。
    - 「全ての置換は互換の積に分解できる」と表現されます。
    - 群論でよく出てくる例です。ここでは説明はしません。
        - 並び替えは群を成すので。
- よって標準基底についての値が定まっているから他全ての値が定まる。
    - 例えば $F^3$ 上だと $\det(e_2,e_3,e_1) = -\det(e_2,e_1,e_3) = \det(e_1,e_2,e_3) = 1$ です。
    - $\mathbb{R}^2$ 上だと $\det((a,b),(c,d)) =ad\det(e_1,e_2)+bc\det(e_2,e_1) = ad-bc$ です。

$n$ 個の $F^n$ の要素は横に並べれば $n\times n$ 行列になるので、これを以て行列式を与える写像 $\det:\mathrm{Mat}_n(F) \to F$ を定義できます。これを使うと**基底の向きを評価できる**のです。すごいですね。

$\det$ は実は**群準同型 $\mathrm{GL}_n(F)\to F^\times$ になる**ことが知られています。ここで $F$ は順序体なので、$F^\times$ は $0$ を境に**正と負に分割されている**はずです。これを使って、$\det M$ が負である方を反転された空間だとみなすのです。この状況は様々な示唆を生みます。

- まず行列式が $1$ であるものを集めると==特殊線形群, special linear group== $\mathrm{SL}_n(F)$ ができ、$\mathrm{GL}_n(F)$ の**正規部分群**になります。
    - 剰余群は $F^\times$ です。
- 直交行列の行列式は $\pm1$ です。
    - $\det(M^T) = \det(M)$ であることが計算でわかるので、ここから従います。
- $\mathrm{O}_n(F)$ の要素で行列式が $1$ であるものを集めると==特殊直交群, special orthogonal group== $\mathrm{SO}_n(F)$ ができ、$\mathrm{O}_n(F)$ の**正規部分群**になります。
    - 剰余群は $(\{1,-1\},\times)\simeq\mathbb{Z}/2\mathbb{Z}$ です。
- つまり正規直交基底には表向きと裏向きが**丁度同じだけ**あり、その**どちらかでしかない**のです。
    - 次元がどれだけ高くてもどんな「表側」の正規直交基底も回せば標準基底になるのです。
- なお反転というのは相対的なものです。標準基底を表側 (行列式が $1$) だと定義したからこうなっています。

この $\mathrm{SO}_n(F)$ が純粋な==回転, rotation==を表現できる世界として振る舞うことになるわけです。これで世界は回し放題です。

> 今の所はできるだけ線形空間の抽象的な性質を使って物事を説明しようとしているのでこういう「情報のない状態から付与していく」スタイルになっています。行列を無から作り出して性質を与えていくような教科書が多いイメージなので。とは言えその方が説明がしやすい箇所があるのは確かなのですが。
> 転置は明らかに行列上で記述したほうが早いです。でもそれを作ったところで使う先が無ければ意味がないと思うのです。そして使う先があるならそこから辿れば定義が出てくるような気がするのです。わかりやすいのかどうかは正直わかりません。

最後に、複素数体 $\mathbb{C}$ の話をします。途中から $F$ は順序体であることを要請したわけで、$\mathbb{C}$ は使えませんでした。根本的には内積の定義で $\langle x,x\rangle\ge 0$ が必要だったことが問題なのですが、複素数 $z=x+iy$ に対して $|z|=\sqrt{x^2+y^2}$ を定義していたはずです。これを使えるように、定義を改造することで==エルミート内積, Hermitian inner product==を備えた空間を定義することができます。

- まず $z=x+iy$ に対して==共役, conjugate== $\bar{z}=x-iy$ を定義します。このとき $z\bar{z} = x^2+y^2\in \mathbb{R}$ となります。
    - なお共役の共役は元に戻ります。
    - また $z=\bar{z}$ のとき $y=0$ より $z\in\mathbb{R}$ です。
- 線形写像ではなく==共役線形写像, conjugate linear map==という概念を次で定義します。
    - $f(x+y) = f(x)+f(y)$ は変わりません。
    - スカラー倍は $f(rx) = \bar{r}f(x)$ という法則に変わります。
- 共役線形写像 $\hat{-}:V\to V^*$ が次を満たすとき、==エルミート内積== $\langle x,y\rangle = \hat{x}(y)$ が定義されます。
    - $\hat{x}(x)\ge 0$ (正定値性)
        - 共役対称性から $\hat{x}(x)$ は実数なのでこの式の意味は定まります。
    - $\hat{x}(y) = \overline{\hat{y}(x)}$ (共役対称性)
- これに伴って**全て**の「転置」は==随伴, adjoint== $M\mapsto M^\dagger$ に置き換わります。
    - ここで $M^\dagger = \overline{M^T}$ で、行列の共役は全要素に共役をつける演算です。
    - 何故なら標準内積は $\langle x,y\rangle = x^\dagger y$ と表せるからです。
        - なお $\langle rx,y\rangle = \bar{r}\langle x,y\rangle, \langle x,ry\rangle = r\langle x,y\rangle$ です。
        
> 双対空間を共役線形写像にして $\hat{-}$ を線形写像にしても本質的には問題はありません。$\dagger$ が真ん中に来るとかっこいいのでこうしました。

これに合わせて直交群の代わりに==ユニタリ群, unitary group== $\mathrm{U}_n(\mathbb{C})$ 及び==特殊ユニタリ群, special unitary group== $\mathrm{SU}_n(\mathbb{C})$ が定義されます。そのうち出てきたり出てこなかったりします。

> 案外 $\mathbb{R}^n$ の回転について考えていても $\mathbb{C}$ っぽさを感じるときがあるのです。
