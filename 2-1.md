## 第二章 線形代数

### 世界の基盤を探して

私達の見ているこの世界を数学の上で表現する方法が今欲しいものです。「求めている構造をうまく表現できるように定式化する」ことを**モデル化**と言います。モデル化というのは所詮モデルで、**正しい**ものであるとは限りません。でも**求めている構造については正しい**わけで、それは1つの大きな参考になるわけです。

> ニュートン力学は「正しく」ありません。何故なら光速ほどに速い物体の挙動が現実と異なるからです。でも求めている構造が「私達が日常で体感できる程度の物体の運動の記述」なのであれば、それはまさしく「正しい」表現であるわけです。**全てはモデル化しないと話が始まりません**。つまり何が表現したいのかがわからないと、求めている構造がわからないと何もできないということです。
> 画像も動画も物理演算も3Dモデルもレイトレーシングも論理回路も秘匿通信もナビエ・ストークス方程式も自然言語も「ある正しさ」の下で成り立っている存在です。**世界の正しさはたくさんあります**。何かを学ぶときにはその正しさを知ることが大事なのかもしれません。

現実世界は結構空間が歪んでいること (重力レンズなど) が知られていて、そのレベルでは光は曲がり放題 (当人はまっすぐのつもりなんですよ) なわけですが。そういう困難を単純化してなかったことにすることである程度シンプルな空間として成り立ってほしいのです。**光線**と呼ぶように、まっすぐであるものはまっすぐであってほしいのです。

「世界がまっすぐである」ことを表現するために、**移動**に成り立つ性質を考えたいと思います。

- 群を成す。
    - 逆向きに移動できる、2つの移動を組み合わせられる。
- 空間全体への群作用がある。
    - 点を移動させることができる。
- **この群は可換**。
    - まっすぐ進んでいるはずなので、どの順番で進んでも同じところに辿り着く。
- **好きなだけ移動量を伸縮させることができる**。
    - ある移動をする代わりにその半分の移動を考えることができる。

4つ目の性質が可換群では足りない重要な点です。「移動の掛け算」というのはちょっと直観から遠いし、実数分の伸縮がさせたいのならそこまでの必要は無いはずです。移動の成す空間とは違う空間を使って、移動に実数を作用させれば良さそうです。

集合 $V$ が**係数体** $F$ の**線形空間**であるとは、次を満たすことを言います。

- $V$ は可換群 $(V,+)$ を成す。
- $F$ の乗法によるモノイド作用である**スカラー倍** $\times: F\times V \to V$ が存在する (演算子は概ね省略)。
    - $a(bv) = (ab)v$
    - $1v = v$
- スカラー倍は $V$ の演算を保つ。
    - $a(v+w) = av+aw$
- スカラー倍は $F$ の加法を保つ。
    - $(a+b)v = av+bv$

自明に $\mathbb{R}$ は $\mathbb{R}$ 係数線形空間になります。重要な例として、$n$ **次元ユークリッド空間** $\mathbb{R}^n$ は $\mathbb{R}$ 係数線形空間になります。スカラー倍は $r\times (x_1,x_2,\ldots,x_n) = (rx_1,rx_2,\ldots,rx_n)$ で与えられます。

> この定義からは特に体である必要はなく環で十分に見えます。その場合は環上の**加群**と呼ばれることになります。体である必要性はそのうち出てきます。

2つの空間 $F$ と $V$ があることは重要です。例えば $a\in F,v\in V$ に対して $av\in V$ は取り出せますが、$va$ という記号は**何も表しません**。定義を考えれば当然ではありますが、区別を明確にするために $V$ の要素を $\mathbf{v}$ と太字にする流派もあります。基本的にはどの値がどの世界に棲んでいるかを知らなければ何も出来ないので、この文章では特に見た目上は区別していません (選ぶ文字は恣意的だと思います)。$F$ の要素は**スカラー**、$V$ の要素は**ベクトル**と呼ばれ、線形空間はベクトル空間とも呼ばれることが多いです。

線形空間を使って「まっすぐな空間の移動」をモデル化することがほとんどです。曲がった空間でさえその基盤には線形空間が出てきます (接空間)。$\mathbb{R}$ 係数 (**実係数**と言います) ということはいくらでも遠くへ伸びるということでもあり、**世界がまっすぐに無限に広がる**ことを表しています。障害物もないのです。

さて、「移動」を考えたところで元の「空間」を考えてみます。2つの点が与えられたらその間を**まっすぐ**行き来する移動が存在するはずです。逆に、ある点と移動が与えられたらその点を移動した結果の点を得られるはずです (群作用になってほしいですね)。

空間を表す集合 $X$ とその世界における移動を表す $F$ 係数線形空間 $V$ が**アフィン空間**であるとは、次を満たすことを言います。

- $V$ 上の群作用である**平行移動** $+: V\times X \to X$ が存在する。
- 任意の $x,y\in X$ に対して一意なベクトル $y-x\in V$ が存在して $x+(y-x)=y$
    - 演算がとてもややこしいことになっています。$y-x$ というのはこの定義によって作られた演算 $-:X\times X\to V$ に $y$ と $x$ を与えたものを表していて、$x+(y-x)$ の $+$ は平行移動を表しています。どちらも $V$ や $F$ の演算ではありません。

**空間の成す世界と移動の成す世界は違う**のです。アフィン空間は**線形空間が $0$ を忘れたもの**と呼ばれることもあり、移動の基準となる $0$ を必要とするスカラー倍などはできないのです。でも、2点の間を**内分**することはできます。

- $F$ 係数線形空間 $V$ 上のアフィン空間 $X$ に対して**線形補間** $\mathrm{lerp}:X\times X \times F \to X$ を次で定義する。
- $\mathrm{lerp}(x,y,a) = x+a(y-x)$
- このとき $\mathrm{lerp}(x,y,0) = x, \mathrm{lerp}(x,y,1) = y$.
    - 群作用なので $0(y-x) = 0$ は平行移動に於いて恒等写像 $1_X$ として振る舞う。
    - $1(y-x) = y-x$ なので定義より $x+(y-x)=y$.

忘れた $0$ を思い返すように、適当な点 $x\in X$ を原点だと思いこむことでアフィン空間は自然に線形空間になります。なのであまりアフィン空間という概念自体は興味深いものではありません。でも感情として「空間が違う」ことは大事だと思います。

> 思い込む、というのは $p\mapsto p - x :X \to V$ で $V$ に点を写すということです。この写像によって $x$ は $0$ に写り、$X$ を $V$ に**埋め込む**ことができるようになるのです。

線形空間は自分自身を移動として捉えたときにアフィン空間になります。なので $\mathbb{R}^n$ の原点 $0$ を忘れたことにすれば $\mathbb{R}^n$ は私達の求める $n$ 次元空間として**ほぼ**振る舞います。これについての特別な話は第三章に置いといて、線形空間自体の興味深い構造をこれから見ていきます。

### 基底と座標

2つの $F$ 係数線形空間の間の構造を保つ写像は**線形写像**と呼ばれ、今まで通り全ての演算を保つことを言っています。

- $f : V\to W$ が線形写像であるとは次を満たすことを言う (**線形性**):
- 群準同型 $V \to W$ である。
- $\forall x\in V. r\in F. f(rx) = rf(x)$

興味深い点として、$f(v_i) = w_i$ という対応が十分取れれば $f : V \to W$ そのものが決定することが知られています。何故なら $V$ の要素を $v_i$ のスカラー倍と群演算で表現することができれば線形性から計算ができるからです。$v = r_1v_1+r_2v_2+\cdots+r_nv_n$ という式を $v_i$ **の線形結合**と呼びます。$f(v) = r_1f(v_1)+r_2f(v_2)+\cdots+r_nf(v_n)$ なわけです。

> これは線形写像というのは「空間のまっすぐさ」を保つために「まっすぐなものはまっすぐにしないといけない」ということです。逆に言えばまっすぐであれば良いので、角度や長さは好き放題になるかもしれません。
> なお $v_i$ などと書いた時、これは暗に写像 $v : \{0,1,\ldots,n\} \to V$ を意味しています。

$V$ の全ての点を**一意的に**線形結合で表現できるような集まり $v_i$ を**基底**と言います。一意的というのは $1\times (2,0)+3\times(1,0) = 2\times(2,0)+1\times (1,0)$ のように複数の $r_i$ の組があっては困るということです。一意性に必要な性質として次があります。

- $v_i$ が基底なら、$r_1v_1+r_2v_2+\cdots+r_nv_n = 0 \Rightarrow r_1=r_2=\cdots=r_n=0$ (**線形独立性**).
   - そうじゃなかったら $0$ の表現方法が一意じゃないので。
   - ここから自動的に $v_i\ne 0$ がわかります。

逆に次が成り立ちます。

- 全ての点を線形結合で表現できる (全域性) ような線形独立な $V$ の要素の集まり $v_i$ は基底。
    - 一意性を言えば良い。$v=\sum r'_iv_i = \sum r_iv_i$ と仮定する。
    - $\sum (r'_i-r_i)v_i = 0$ なので線形独立性より $\forall i. r_i = r'_i$
    - よって一意なので基底。

線形空間に $n$ 要素の基底が存在するとき ($n\in\mathbb{N}$)、$n$ **次元線形空間**及び**有限次元線形空間**と言います。$n$ 次元ユークリッド空間 $\mathbb{R}^n$ は直観通り $n$ 次元線形空間になり、一般に次が成り立ちます。

- $F^n$ は $F$ 係数 $n$ 次元線形空間。
    - $e_1=(1,0,0,\ldots,0), e_2 = (0,1,0,\ldots,0),\ldots,e_n = (0,0,0,\ldots,1)$ を取るとこれは明らかに基底。
    - これを**標準基底**と呼ぶ。
    
**興味深いことに、逆が成り立ちます**。

- $F$ 係数 $n$ 次元線形空間 $V$ は $F^n$ に同型。
    - 基底 $v_i$ があるとき、$v\in V$ に対して線形結合の係数を集めたもの $(r_1,r_2,\ldots,r_n)\in F^n$ を与える写像 $f$ が考えられる。
    - これは線形写像。
    - 逆に $g = (r_1,r_2,\ldots,r_n) \mapsto r_1v_1+r_2v_2+\cdots+r_nv_n$ という対応も線形写像。
    - $g\circ f$ は明らかに $1_V$ に等しい。
    - $f\circ g$ も明らかに $1_{F^n}$ に等しい。
    
この対応 $f:V \simeq F^n$ によって**ある基底を使うと** $V$ の要素を**具体的に** $F^n$ の要素として表現できることがわかります。これを**座標**と呼びます。

> $V$ という集合はほぼ何が入っているかわからないものでした。うまく計算さえできれば本当になんでもよかったのです。だけど、そんなよくわからない世界もよく見るとただの $F^n$ と同じだと考えていい、というのはとてもありがたいことなのです。
> ちなみにここで基底の存在は重要です。基底は存在するけどどれかわからない、という状況なはずで、基底を使って何かを定義した場合にはそれが**別の基底を使っても等しい値が取り出せる**必要があるのです。当分はこの問題は起きないので気にしないで大丈夫です。

次の性質は実は自明ではありません。

- $m\ne n$ のとき、線形空間として $F^n\not\simeq F^m$
    - $n < m$ を仮定しても**一般性を失わない**。
        - $m < n$ なら全部逆にすればいいため。命題に対称性があるときはよくこう書かれる。
    - 「$n < m$ のとき $F^n\not\simeq F^m$」を $n$ に関する帰納法で示す。
        - $n=0$ で成り立つ:
            - $F^0 = \{0\}$ なので $F^m$ との全単射が存在しない。
                - 体は少なくとも異なる $0$ と $1$ を持つため。
        - $n=k$ で成り立つとすると $n=s(k)$ で成り立つ:
            - $k<m$ のとき $F^k\not\simeq F^m$ とする。
            - $F^{s(k)}\simeq F^{s(m)}$ と仮定すると矛盾。
                - $F^{s(m)}$ の標準基底の要素 $e_1$ をこの同型で写した先を $u\in F^{s(k)}$ とする。
                - $F^{s(k)}$ の基底 $u_i$ で $u_1 = u$ となるものが存在する。
                    - $u$ が標準基底のある要素と一致するならそれを $u_1$ とする。
                    - そうでないなら標準基底の $e_1$ を $u$ に置き換えればこれは基底。
                - この $s(k)$ 要素の基底を同型で写した先を $w_i$ とすると、これは $F^{s(m)}$ の基底。
                    - このとき $w_1 = e_1$ である。
                - $w'_1 = w_1 = e_1, w'_i = w_i-(w_i)_1e_i\ (i>1)$ とすると、これも $F^{s(m)}$ の基底。
                    - ここで $(w_i)_j$ は $w_i = (a_1,\ldots,a_{s(m)})$ としたときの $j$ 番目の要素。
                    - このとき $\forall i>1. (w'_i)_1 = 0$ となる。
                - $r'_2w'_2+\cdots+r'_{s(k)}w'_{s(k)}$ で表現できるベクトルの集合 $W'$ は、$F^{s(m)}$ の1番目の要素が $0$ であるようなベクトルの集合 $W$ と等しい。
                    - $W'\subseteq W$ は自明。$W\subseteq W'$ を示す。
                    - 任意の $w\in W$ を取る。
                        - $w = r'_2w'_2+\cdots+r'_{s(k)}w'_{s(k)}$ と表現できないと仮定する。
                        - このとき $w = r'_1w'_1+r'_2w'_2+\cdots+r'_{s(k)}w'_{s(k)}, r'_1\ne 0$ と表現できる。
                        - すると $w$ の1番目の要素は $0$ でない。よって矛盾。
                    - 従って $w\in W'$ である。
                - この集合は線形空間を成し、$k$ 要素の基底と $m$ 要素の基底が存在している。
                - よって $F^k \simeq F^m$ より矛盾。
            - よって $s(k)<m'$ のとき $F^{s(k)}\not\simeq F^{m'}$ である。

以上から次が成り立ちます。

- $m\ne n$ のとき、$n$ 次元線形空間は $m$ 次元線形空間ではない。
    - ある $n$ 次元線形空間が $m$ 次元線形空間だとする。
    - すると $F^n\simeq F^m$ より矛盾。

つまり次元はちゃんと定まるということです。これによって有限次元線形空間 $V$ の次元を $\dim V$ で表すことができるようになりました。

> 無限次元の場合は面倒な状況にあります。線形結合に「$r_i\ne 0$ となる $i$ は有限個」という条件を加えるとほぼそのまま拡張できます (線形結合の結果が定義できるため) が**表現力が足りません**。例えば $f: A \to \mathbb{R}$ は $A$ の各点で演算を定義すれば $\mathbb{R}$ 係数線形空間になりますが、$A$ が無限集合だと上の方法だと基底が取れません。無限次元線形空間には興味深い例がたくさんありはするものの、扱いが怖いイメージがあります。

線形空間について考えるときは $F^n$ について考えればよく、アフィン空間は実質線形空間なので結局私達が興味を持つべき世界は $F^n$ だということになります。特に空間について考えるときは**変換**を考えたいことが多いので、次からは $F^m$ から $F^n$ への線形写像について考えていくことにします。
